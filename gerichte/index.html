<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <style>
    body {
      background: black !important;
      color: white !important;
      font-size: 80%;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    table td,
    table th {
      border: 1px solid #333 !important;
      padding: 5px;
      border-radius: 2px;
      width: 1%;
      text-align: center;
    }
    
    table th {
      position: relative;
    }
    
    /* Pfeile für Sortierung */
    th[data-sort-order="asc"]::after {
      content: " ↑";
      color: #fff;
    }
    
    th[data-sort-order="desc"]::after {
      content: " ↓";
      color: #fff;
    }
    
    .search-row th input {
      border: none;
      padding: 5px;
      background: #333;
      color: white;
      width: 50px;
    }
    
    .row-counter {
      margin-top: 5px;
      background: #333;
      padding: 5px 10px;
      border-radius: 2px;
    }
    
    .tag {
      float: left;
      display: block;
      padding: 2px 10px;
      border-radius: 2px;
      margin: 2px;
    }
    
    .tvegan {
      background: green !important;
      color: white !important;
    }
    
    .tvegan::after {
      content: "vegan";
    }
    
    .tglutnfree {
      background: orangered !important;
      color: white !important;
    }
    
    .tglutnfree::after {
      content: "glutenfrei";
    }
    
    .tprotein {
      background: royalblue !important;
      color: white !important;
    }
    
    .tprotein::after {
      content: "proteinreich";
    }
    
    .tabwechslung {
      background: blueviolet !important;
      color: white !important;
    }
    
    .tabwechslung::after {
      content: "healthy";
    }
    
    .tverarbeitet {
      background: darkgrey !important;
      color: white !important;
    }
    
    .tverarbeitet::after {
      content: "verarbeitet";
    }
    
    .taniedrig {
      background: darkgreen !important;
      color: lightgreen !important;
    }
    
    .taniedrig::after {
      content: "niedrig";
    }
    
    .tamittel {
      background: darkgoldenrod !important;
      color: gold !important;
    }
    
    .tamittel::after {
      content: "mittel";
    }
    
    .tahoch {
      background: darkred !important;
      color: orangered !important;
    }
    
    .tahoch::after {
      content: "hoch";
    }
  </style>
</head>

<body>
  <table id="searchsorttable">
    <thead>
      <tr>
        <th>NAME</th>
        <th>TAGS</th>
        <th>AUFWAND</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Pommes mit Käsesauce</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
        </td>
        <td>
          <span class="tag tamittel"></span>
        </td>
      </tr>
      <tr>
        <td>Babica's Kartoffelsalat</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
        </td>
        <td>
          <span class="tag tamittel"></span>
        </td>
      </tr>
      <tr>
        <td>brotlose Burgerpatties mit Salat</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tprotein"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Reispfanne im Weizentortilla "Burrito"</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tprotein"></span>
          <span class="tag tabwechslung"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag taniedrig"></span></td>
      </tr>
      <tr>
        <td>Käsespätzle</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag taniedrig"></span></td>
      </tr>
      <tr>
        <td>Linsencurry</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tprotein"></span>
        </td>
        <td><span class="tag taniedrig"></span></td>
      </tr>
      <tr>
        <td>afrikanisches Süßkartoffelcurry</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tprotein"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Kürbissuppe</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
        </td>
        <td><span class="tag taniedrig"></span></td>
      </tr>
      <tr>
        <td>Asia Ingwer-Pilz Suppe</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>Standard Reispfanne</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tprotein"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>Standard Salat</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tprotein"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>Mushrom Tikka Masala</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>Kartoffeln mit Sauce Hollandaise</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>Spargel mit Sauce Hollandaise</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>grüner Spargel im Blätterteigmantel</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>Blumenkohl Tikka Masala</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Knoblauchsuppe</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Chili Cheese Fries</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Nudeln mit Käsesauce und Pilzen</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag tamittel"></span></td>
      </tr>
      <tr>
        <td>Paprika Cremesuppe</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tglutnfree"></span>
        </td>
        <td><span class="tag taniedrig"></span></td>
      </tr>
      <tr>
        <td>Standard Wraps</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tverarbeitet"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Weihnachtsmarkt Champignons</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tverarbeitet"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Standard Pizza</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tverarbeitet"></span>
          <span class="tag tglutnfree"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <tr>
        <td>Standard Lasagne</td>
        <td>
          <span class="tag tvegan"></span>
          <span class="tag tverarbeitet"></span>
          <span class="tag tabwechslung"></span>
        </td>
        <td><span class="tag tahoch"></span></td>
      </tr>
      <td>TK-Pizza</td>
      <td>
        <span class="tag tverarbeitet"></span>
      </td>
      <td><span class="tag taniedrig"></span></td>
      </tr>
      <td>Gobi Manchurian</td>
<td>
  <span class="tag tvegan"></span>
  <span class="tag tglutnfree"></span>
</td>
<td><span class="tag tahoch"></span></td>
</tr>
    </tbody>
  </table>
  
  <script>
    function enhanceTable(tableid) {
      const table = document.getElementById(tableid);
      if (!table) return;
      
      // Add our custom class to the table
      table.classList.add('enhanced-table');
      
      const headers = Array.from(table.querySelectorAll('thead th'));
      const tbody = table.querySelector('tbody');
      const rows = Array.from(tbody.querySelectorAll('tr'));
      
      // Create search row
      const searchRow = document.createElement('tr');
      searchRow.classList.add('search-row');
      
      headers.forEach(() => {
        const th = document.createElement('th');
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = '...';
        input.addEventListener('input', performSearch);
        th.appendChild(input);
        searchRow.appendChild(th);
      });
      
      // Insert search row after header
      table.querySelector('thead').appendChild(searchRow);
      
      // Add sort functionality to headers
      headers.forEach((header, index) => {
        header.style.cursor = 'pointer';
        header.dataset.sortOrder = 'none';
        header.addEventListener('click', () => sortTable(index));
      });
      
      // Create and add row counter
      const counterDiv = document.createElement('div');
      counterDiv.classList.add('row-counter');
      table.parentNode.insertBefore(counterDiv, table.nextSibling);
      updateRowCounter();
      
      // Hilfsfunktion: Extrahiert Tags aus einer Zelle
      function getTagsFromCell(cell) {
        return Array.from(cell.querySelectorAll('.tag'))
          .map(tag => tag.className.split(' ')[1]); // Klasse wie 'tvegan', 'tprotein' usw.
      }
      
      // Sort function
      function sortTable(columnIndex) {
        const header = headers[columnIndex];
        const currentOrder = header.dataset.sortOrder;
        
        // Reset other headers
        headers.forEach(h => {
          if (h !== header) h.dataset.sortOrder = 'none';
        });
        
        // Determine new sort order
        const newOrder = currentOrder === 'asc' ? 'desc' : 'asc';
        header.dataset.sortOrder = newOrder;
        
        // Sort rows
        const sortedRows = rows.slice().sort((a, b) => {
          // Spezielle Behandlung für die Tag-Spalte (Index 1)
          if (columnIndex === 1) {
            const aTags = getTagsFromCell(a.cells[columnIndex]);
            const bTags = getTagsFromCell(b.cells[columnIndex]);
            
            // Sortieren nach Anzahl der Tags
            if (newOrder === 'asc') {
              return aTags.length - bTags.length;
            } else {
              return bTags.length - aTags.length;
            }
          }
          
          // Spezielle Behandlung für die Aufwand-Spalte (Index 2)
          if (columnIndex === 2) {
            const aTag = a.cells[columnIndex].querySelector('.tag');
            const bTag = b.cells[columnIndex].querySelector('.tag');
            
            const aufwandRank = {
              'taniedrig': 1,
              'tamittel': 2,
              'tahoch': 3
            };
            
            const aRank = aTag ? aufwandRank[aTag.className.split(' ')[1]] || 0 : 0;
            const bRank = bTag ? aufwandRank[bTag.className.split(' ')[1]] || 0 : 0;
            
            return newOrder === 'asc' ? aRank - bRank : bRank - aRank;
          }
          
          // Standard-Sortierung für andere Spalten
          const aValue = a.cells[columnIndex].textContent.trim();
          const bValue = b.cells[columnIndex].textContent.trim();
          
          // Check if values are numbers
          const aNum = parseFloat(aValue);
          const bNum = parseFloat(bValue);
          
          if (!isNaN(aNum) && !isNaN(bNum)) {
            return newOrder === 'asc' ? aNum - bNum : bNum - aNum;
          }
          
          // String comparison
          return newOrder === 'asc' ?
            aValue.localeCompare(bValue) :
            bValue.localeCompare(aValue);
        });
        
        // Re-append rows in new order
        sortedRows.forEach(row => tbody.appendChild(row));
      }
      
      // Search function
      function performSearch() {
        const searchValues = Array.from(searchRow.querySelectorAll('input'))
          .map(input => input.value.toLowerCase());
        
        rows.forEach(row => {
          let showRow = true;
          
          // Für jede Spalte prüfen
          for (let i = 0; i < searchValues.length; i++) {
            if (!searchValues[i]) continue; // Leere Suche überspringen
            
            const cell = row.cells[i];
            
            // Spezielle Behandlung für Tag-Spalte (Index 1)
            if (i === 1) {
              const tagSearch = searchValues[i];
              const tags = Array.from(cell.querySelectorAll('.tag'));
              const tagTexts = tags.map(tag => tag.textContent.toLowerCase());
              const tagClasses = tags.map(tag =>
                Array.from(tag.classList)
                .filter(cls => cls.startsWith('t'))
                .join(' ')
                .toLowerCase()
              );
              
              // Prüfen, ob ein Tag den Suchbegriff enthält
              const tagMatch = tagTexts.some(text => text.includes(tagSearch)) ||
                tagClasses.some(cls => cls.includes(tagSearch));
              
              if (!tagMatch) {
                showRow = false;
                break;
              }
            }
            // Spezielle Behandlung für Aufwand-Spalte (Index 2)
            else if (i === 2) {
              const aufwandSearch = searchValues[i];
              const aufwandTag = cell.querySelector('.tag');
              
              if (!aufwandTag ||
                !aufwandTag.textContent.toLowerCase().includes(aufwandSearch) &&
                !aufwandTag.className.toLowerCase().includes(aufwandSearch)) {
                showRow = false;
                break;
              }
            }
            // Standard-Suche für andere Spalten
            else {
              const cellText = cell.textContent.toLowerCase();
              if (!cellText.includes(searchValues[i])) {
                showRow = false;
                break;
              }
            }
          }
          
          row.style.display = showRow ? '' : 'none';
        });
        
        updateRowCounter();
      }
      
      // Row counter function
      function updateRowCounter() {
        const visibleRowCount = rows.filter(
          row => row.style.display !== 'none'
        ).length;
        
        counterDiv.textContent = `Showing ${visibleRowCount} of ${rows.length} rows`;
      }
    }
    
    enhanceTable('searchsorttable');
  </script>
</body>

</html>